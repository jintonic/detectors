#include <TGraph.h>
#include <UNIC/Units.h>
using namespace UNIC;

#include "CsI.h"
using namespace MAD;

TGraph* CsI::Sp()
{
   if (fSp) return fSp;

   const int n = 132;
   double ep[n]={1.000E-03, 1.500E-03, 2.000E-03, 2.500E-03, 3.000E-03,
      4.000E-03, 5.000E-03, 6.000E-03, 7.000E-03, 8.000E-03, 9.000E-03,
      1.000E-02, 1.250E-02, 1.500E-02, 1.750E-02, 2.000E-02, 2.250E-02,
      2.500E-02, 2.750E-02, 3.000E-02, 3.500E-02, 4.000E-02, 4.500E-02,
      5.000E-02, 5.500E-02, 6.000E-02, 6.500E-02, 7.000E-02, 7.500E-02,
      8.000E-02, 8.500E-02, 9.000E-02, 9.500E-02, 1.000E-01, 1.250E-01,
      1.500E-01, 1.750E-01, 2.000E-01, 2.250E-01, 2.500E-01, 2.750E-01,
      3.000E-01, 3.500E-01, 4.000E-01, 4.500E-01, 5.000E-01, 5.500E-01,
      6.000E-01, 6.500E-01, 7.000E-01, 7.500E-01, 8.000E-01, 8.500E-01,
      9.000E-01, 9.500E-01, 1.000E+00, 1.250E+00, 1.500E+00, 1.750E+00,
      2.000E+00, 2.250E+00, 2.500E+00, 2.750E+00, 3.000E+00, 3.500E+00,
      4.000E+00, 4.500E+00, 5.000E+00, 5.500E+00, 6.000E+00, 6.500E+00,
      7.000E+00, 7.500E+00, 8.000E+00, 8.500E+00, 9.000E+00, 9.500E+00,
      1.000E+01, 1.250E+01, 1.500E+01, 1.750E+01, 2.000E+01, 2.500E+01,
      2.750E+01, 3.000E+01, 3.500E+01, 4.000E+01, 4.500E+01, 5.000E+01,
      5.500E+01, 6.000E+01, 6.500E+01, 7.000E+01, 7.500E+01, 8.000E+01,
      8.500E+01, 9.000E+01, 9.500E+01, 1.000E+02, 1.250E+02, 1.500E+02,
      1.750E+02, 2.000E+02, 2.250E+02, 2.500E+02, 2.750E+02, 3.000E+02,
      3.500E+02, 4.000E+02, 4.500E+02, 5.000E+02, 5.500E+02, 6.000E+02,
      6.500E+02, 7.000E+02, 7.500E+02, 8.000E+02, 8.500E+02, 9.000E+02,
      9.500E+02, 1.000E+03, 1.500E+03, 2.000E+03, 2.500E+03, 3.000E+03,
      4.000E+03, 5.000E+03, 6.000E+03, 7.000E+03, 8.000E+03, 9.000E+03,
      1.000E+04};
   double se[n]={3.467E+01, 4.246E+01, 4.903E+01, 5.482E+01, 6.005E+01,
      6.934E+01, 7.752E+01, 8.492E+01, 9.173E+01, 9.806E+01, 1.040E+02,
      1.096E+02, 1.210E+02, 1.309E+02, 1.399E+02, 1.480E+02, 1.555E+02,
      1.623E+02, 1.686E+02, 1.745E+02, 1.849E+02, 1.940E+02, 2.018E+02,
      2.085E+02, 2.142E+02, 2.190E+02, 2.230E+02, 2.263E+02, 2.289E+02,
      2.310E+02, 2.325E+02, 2.334E+02, 2.340E+02, 2.341E+02, 2.304E+02,
      2.219E+02, 2.114E+02, 2.006E+02, 1.901E+02, 1.806E+02, 1.719E+02,
      1.641E+02, 1.511E+02, 1.406E+02, 1.321E+02, 1.251E+02, 1.191E+02,
      1.140E+02, 1.096E+02, 1.056E+02, 1.021E+02, 9.892E+01, 9.583E+01,
      9.283E+01, 8.995E+01, 8.722E+01, 7.576E+01, 6.741E+01, 6.126E+01,
      5.663E+01, 5.299E+01, 4.988E+01, 4.724E+01, 4.491E+01, 4.101E+01,
      3.783E+01, 3.519E+01, 3.295E+01, 3.103E+01, 2.935E+01, 2.787E+01,
      2.657E+01, 2.539E+01, 2.433E+01, 2.336E+01, 2.248E+01, 2.167E+01,
      2.093E+01, 1.795E+01, 1.580E+01, 1.417E+01, 1.288E+01, 1.096E+01,
      1.023E+01, 9.603E+00, 8.580E+00, 7.781E+00, 7.138E+00, 6.609E+00,
      6.166E+00, 5.788E+00, 5.462E+00, 5.178E+00, 4.928E+00, 4.706E+00,
      4.507E+00, 4.329E+00, 4.168E+00, 4.021E+00, 3.451E+00, 3.058E+00,
      2.770E+00, 2.551E+00, 2.378E+00, 2.238E+00, 2.123E+00, 2.027E+00,
      1.875E+00, 1.762E+00, 1.674E+00, 1.604E+00, 1.548E+00, 1.502E+00,
      1.463E+00, 1.431E+00, 1.404E+00, 1.381E+00, 1.361E+00, 1.344E+00,
      1.329E+00, 1.317E+00, 1.252E+00, 1.238E+00, 1.241E+00, 1.251E+00,
      1.278E+00, 1.305E+00, 1.330E+00, 1.354E+00, 1.375E+00, 1.394E+00,
      1.412E+00};

   fSp = new TGraph(n,ep,se);
   return fSp;
}

//______________________________________________________________________________
//

double CsI::Sp(double protonEnergy)
{
   return Sp()->Eval(protonEnergy/MeV)*MeV*cm2/g;
}

